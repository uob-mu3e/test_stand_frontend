<!DOCTYPE html>
<html lang="en">
	<head>
		<!-- Encoding -->
	   <meta charset="UTF-8">

	   <link rel="stylesheet" href="midas.css">
	   
       <script src="controls.js"></script>
	   <script src="midas.js"></script>
	   <script src="mhttpd.js"></script>

	   <title>Testing</title>

       <script>
           function load() {
            mhttpd_init('Testing')
           }
       </script>
	</head>

	<body class="mcss" onload="load()">
		<!-- header and side navigation will be filled in mhttpd_start -->
		<div id="mheader"></div>
		<div id="msidenav"></div>


		<div id="mmain">
            <h1>Hola mundo</h1>
            <button>Press me</button>

            <script>
                heading = document.querySelector('h1')               
                button = document.querySelector('button')

                button.addEventListener('click', get_lv_current.bind(this, 0));

                async function hola(){
                    let curr = await get_lv_current(1);
                    heading.innerText = curr;
                }

                async function get_lv_current(channel) {
                    console.log(channel)
                    try {
                        let result_rpc = await mjsonrpc_db_get_values(["/Equipment/HAMEG0/Variables/Current[" + channel.toString() + "]"]);
                        console.log(result_rpc.result.data[0])
                        let result_rpc2 = await mjsonrpc_db_get_values(["/Equipment/HAMEG0/Variables/Current[" + (channel+1).toString() + "]"]);
                        console.log(result_rpc2.result.data[0])
                        let result_rpc3 = await mjsonrpc_db_get_values(["/Equipment/HAMEG0/Variables/Current[" + (channel+3).toString() + "]"]);
                        console.log(result_rpc3.result.data[0])
                    }catch (err){
                        mjsonrpc_error_alert(err);
                        console.log("Could not get lv current from ODB:", err)
                        return 0;
                    }
                }
            </script>

		</div>


	</body>
</html>
