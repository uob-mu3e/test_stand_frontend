#!/bin/bash
set -euf

PREFIX=@CMAKE_INSTALL_PREFIX@
SOURCE=@PROJECT_SOURCE_DIR@
BINDIR=${PREFIX}/bin
LIBDIR=${PREFIX}/lib

source "${PREFIX}/set_env.sh"

CUDA=@CUDA_FOUND@

echo "$CUDA"

cd "${SOURCE}/online"


#create custom pages for DAQ slow control
#odbedit -d Custom -c 'create STRING SC'
#odbedit -c 'set Custom/SC sc.html'
#odbedit -d Custom -c 'create STRING SciFi-ASICs'
#odbedit -c 'set Custom/SciFi-ASICs mutrigTdc.html'
#odbedit -d Custom -c 'create STRING MALIBU'
#odbedit -c 'set Custom/MALIBU TileGUI/MALIBUMonitor/Monitor.html'
#odbedit -d Custom -c 'create STRING MuPix'
#odbedit -c 'set Custom/MuPix MuPixTB.html'
#set Analysis
#odbedit -d Custom -c 'create STRING TileAna '
#odbedit -c 'set Custom/TileAna ana_mutrig/mutrig/tile_ana.html'

xterm -hold -e "mhttpd" &
sleep 0.2
xterm -hold -e "mserver" &
sleep 0.2
# Start front-ends before the logger!
xterm -hold -e "crfe" &
sleep 0.2
if [[ "$CUDA" = "TRUE" ]]; then
    xterm -hold -e "msysmon-nvidia" &
else
    xterm -hold -e "msysmon" &
fi;
sleep 0.2
xterm -hold -e "switch_fe" &
sleep 0.2
xterm -hold -e "mlogger" &
#xterm -hold -e "switch_fe" &
#xterm -hold -e "malibu_fe" &

sleep 2

